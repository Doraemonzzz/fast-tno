[1/3] /opt/rh/devtoolset-9/root/usr/bin/g++ -MMD -MF fftconv.o.d -DTORCH_EXTENSION_NAME=tno_causal_v12 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include -I/nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/TH -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/THC -isystem /nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/include/python3.8 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -g -march=native -funroll-loops -c /nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv.cpp -o fftconv.o 
FAILED: fftconv.o 
/opt/rh/devtoolset-9/root/usr/bin/g++ -MMD -MF fftconv.o.d -DTORCH_EXTENSION_NAME=tno_causal_v12 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include -I/nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/TH -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/THC -isystem /nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/include/python3.8 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -g -march=native -funroll-loops -c /nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv.cpp -o fftconv.o 
/nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv.cpp:8:10: fatal error: cuda_fp16.h: No such file or directory
    8 | #include <cuda_fp16.h>
      |          ^~~~~~~~~~~~~
compilation terminated.
[2/3] /nvme/share/cuda-11.8/bin/nvcc  -ccbin /opt/rh/devtoolset-9/root/usr/bin/gcc -DTORCH_EXTENSION_NAME=tno_causal_v12 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include -I/nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/TH -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/THC -isystem /nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/include/python3.8 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 --compiler-options '-fPIC' -O3 --threads 4 -lineinfo --use_fast_math -std=c++17 -arch=compute_70 -c /nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv_cuda.cu -o fftconv_cuda.cuda.o 
FAILED: fftconv_cuda.cuda.o 
/nvme/share/cuda-11.8/bin/nvcc  -ccbin /opt/rh/devtoolset-9/root/usr/bin/gcc -DTORCH_EXTENSION_NAME=tno_causal_v12 -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include -I/nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/TH -isystem /nvme/zhongyiran/miniconda3/envs/tno/lib/python3.8/site-packages/torch/include/THC -isystem /nvme/share/cuda-11.8/include -isystem /nvme/zhongyiran/miniconda3/envs/tno/include/python3.8 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_80,code=compute_80 -gencode=arch=compute_80,code=sm_80 --compiler-options '-fPIC' -O3 --threads 4 -lineinfo --use_fast_math -std=c++17 -arch=compute_70 -c /nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv_cuda.cu -o fftconv_cuda.cuda.o 
/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(177): error: no operator "+=" matches these operands
            operand types are: __half2 += __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(181): error: no operator "-=" matches these operands
            operand types are: __half2 -= __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(185): error: no operator "*=" matches these operands
            operand types are: __half2 *= __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(186): error: no operator "*=" matches these operands
            operand types are: __half2 *= __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(190): error: no operator "/=" matches these operands
            operand types are: __half2 /= __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(191): error: no operator "/=" matches these operands
            operand types are: __half2 /= __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(202): error: no operator "+" matches these operands
            operand types are: __half2 + const __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(203): error: no operator "+" matches these operands
            operand types are: __half2 + const __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(208): error: no operator "-" matches these operands
            operand types are: __half2 - const __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(209): error: no operator "-" matches these operands
            operand types are: __half2 - const __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(215): error: no operator "-" matches these operands
            operand types are: - __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/mathdx/22.02/include/cufftdx/include/detail/../traits/detail/../../database/detail/../../traits/detail/../../types.hpp(216): error: no operator "*" matches these operands
            operand types are: __half2 * const __half2

/nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv_cuda.cu(937): error: identifier "D_val" is undefined
          detected during:
            instantiation of "void fftconv_bwd_cuda<GELU_OUTPUT,FFT_SIZE,EPT,input_t,output_t>(const output_t *, const input_t *, const c10::complex<float> *, const input_t *, int, const input_t *, const float *, input_t *, c10::complex<float> *, float *, input_t *, __nv_bool, __nv_bool, __nv_bool, int, int, int, size_t, size_t, __nv_bool, __nv_bool) [with GELU_OUTPUT=true, FFT_SIZE=8U, EPT=4U, input_t=float, output_t=float]" 
(1164): here
            instantiation of "void fftconv_bwd_cuda_dispatch(const output_t *, const input_t *, const c10::complex<float> *, const input_t *, int, const input_t *, const float *, input_t *, c10::complex<float> *, float *, input_t *, __nv_bool, __nv_bool, __nv_bool, int, int, int, size_t, size_t, int, __nv_bool, __nv_bool) [with input_t=float, output_t=float]" 
(1270): here

/nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv_cuda.cu(742): warning #177-D: variable "dD_val" was declared but never referenced
          detected during:
            instantiation of "void fftconv_bwd_cuda<GELU_OUTPUT,FFT_SIZE,EPT,input_t,output_t>(const output_t *, const input_t *, const c10::complex<float> *, const input_t *, int, const input_t *, const float *, input_t *, c10::complex<float> *, float *, input_t *, __nv_bool, __nv_bool, __nv_bool, int, int, int, size_t, size_t, __nv_bool, __nv_bool) [with GELU_OUTPUT=true, FFT_SIZE=8U, EPT=4U, input_t=float, output_t=float]" 
(1164): here
            instantiation of "void fftconv_bwd_cuda_dispatch(const output_t *, const input_t *, const c10::complex<float> *, const input_t *, int, const input_t *, const float *, input_t *, c10::complex<float> *, float *, input_t *, __nv_bool, __nv_bool, __nv_bool, int, int, int, size_t, size_t, int, __nv_bool, __nv_bool) [with input_t=float, output_t=float]" 
(1270): here

13 errors detected in the compilation of "/nvme/zhongyiran/code/fast-tno/src/fftconv/fftconv_cuda.cu".
ninja: build stopped: subcommand failed.
